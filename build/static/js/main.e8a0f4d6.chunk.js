(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{163:function(e,t,a){e.exports=a(311)},168:function(e,t,a){},311:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(20),o=a.n(i),l=a(23),s=a(24),c=a(26),m=a(25),u=a(27),p=a(53),h=a(21),f=(a(168),a(313)),d=a(321),g=f.a.Header,y=f.a.Content,b=f.a.Sider,E=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(f.a,null,r.a.createElement(g,{className:"header",style:{color:"white",fontSize:24}},r.a.createElement("div",{className:"logo"},"Welcome to Image Process App!")),r.a.createElement(f.a,null,r.a.createElement(b,{width:200,className:"site-layout-background"},r.a.createElement(d.a,{mode:"inline",style:{height:"100%",borderRight:0}},r.a.createElement(d.a.Item,{key:"/home",onClick:function(t){return e.props.history.push(t.key)}},"Home"),r.a.createElement(d.a.Item,{key:"/save",onClick:function(t){return e.props.history.push(t.key)}},"Save Images"),r.a.createElement(d.a.Item,{key:"/search",onClick:function(t){return e.props.history.push(t.key)}},"Search Images"))),r.a.createElement(f.a,{style:{padding:"0 24px 24px"}},r.a.createElement(y,{className:"site-layout-background",style:{padding:24,margin:0,minHeight:280}},this.props.children))))}}]),t}(r.a.Component),O=Object(h.g)(E),j=a(322),v=a(85),w=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).home=function(){a.props.history.push("/")},a.deleteAll=function(){var e=a.props.match.params.id,t=a.props.match.params.name;a.props.history.push({pathname:"/related/"+e+"/"+t,state:{filter:"origin"}})},a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(j.a,{status:"warning",title:"Sorry, you can't delete origin image only",subTitle:"You can delete all related images or cancel delete",extra:[r.a.createElement(v.a,{type:"primary",key:"cancel",onClick:this.home},"Cancel"),r.a.createElement(v.a,{key:"delete",onClick:this.deleteAll},"Delete all related")]}))}}]),t}(n.Component),k=Object(h.g)(w),N=a(16),C=a.n(N),S=a(38),I=a(78),x=a(47),T=a(317),P=T.a.Meta,F=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).deleteImage=Object(S.a)(C.a.mark(function e(){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("deleteone"),e.next=3,fetch("/api/del",{body:JSON.stringify({id:a.props.id,name:a.props.name}),headers:{"Content-Type":"application/json"},method:"POST"}).then(function(e){return e.json()}).then(function(e){console.log(e),a.props.history.push("/")}).catch(function(e){return console.log(e)});case 3:e.sent;case 4:case"end":return e.stop()}},e,this)})),a.handleDelete=function(){console.log(4567);var e=a.props.id,t=a.props.name;a.props.history.push({pathname:"/error/"+e+"/"+t})},a.showRelated=function(){var e=a.props.id,t=a.props.name;a.props.history.push({pathname:"/related/"+e+"/"+t,state:{filter:a.props.filterName}})},a.update=function(){var e=a.props.id,t=a.props.name;a.props.history.push({pathname:"/update/"+e+"/"+t})},a.state={imageList:[]},a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(T.a,{size:"small",style:{width:300},cover:r.a.createElement("img",{alt:this.props.id,src:"https://images-management.s3-ap-southeast-1.amazonaws.com/"+this.props.s3Key}),actions:[r.a.createElement(v.a,{type:"primary",onClick:this.update},"Update"),r.a.createElement(v.a,{type:"primary",onClick:"origin"===this.props.filterName?this.handleDelete:this.deleteImage},"Delete"),r.a.createElement(v.a,{type:"primary",onClick:this.showRelated},"Related")]},r.a.createElement(P,{title:this.props.name,description:"UploadTime: "+this.props.time}))}}]),t}(n.Component),K=Object(h.g)(F),L=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).componentDidMount=function(){a.getOriginImages().then(function(e){return e.json()}).then(function(e){a.setState({imageList:e.findImagesByFilterType}),console.log(111),console.log(e)}).catch(function(e){return console.log(e)})},a.getOriginImages=Object(S.a)(C.a.mark(function e(){var t;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/images");case 2:if(200===(t=e.sent).status){e.next=5;break}throw Error(t.statusText);case 5:return e.abrupt("return",t);case 6:case"end":return e.stop()}},e,this)})),a.state={imageList:[]},a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.state.imageList;return r.a.createElement("div",null,r.a.createElement(I.a,{gutter:16},e.map(function(e,t){return r.a.createElement(x.a,{span:8,key:t},r.a.createElement(K,{name:e.name,time:e.time,id:e.id,s3Key:e.s3Key,filterName:e.filterName}))})))}}]),t}(n.Component),B=Object(h.g)(L),D=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,"404")}}]),t}(n.Component),G=a(314),J=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).componentDidMount=function(){console.log(987),a.getRelatedImages().then(function(e){return e.json()}).then(function(e){console.log(e),"origin"===a.state.filterName?a.setState({imageList:e.getImagesByOriginImage}):a.setState({imageList:[e.findImageByFilteredImage]}),console.log(a.state.imageList),console.log(134)}).catch(function(e){return console.log(e)})},a.getRelatedImages=Object(S.a)(C.a.mark(function e(){var t;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/related",{body:JSON.stringify({id:a.state.id,filterName:a.state.filterName}),headers:{"Content-Type":"application/json"},method:"POST"});case 2:if(200===(t=e.sent).status){e.next=5;break}throw Error(t.statusText);case 5:return console.log(234),console.log(t),e.abrupt("return",t);case 8:case"end":return e.stop()}},e,this)})),a.deleteAll=Object(S.a)(C.a.mark(function e(){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/delete",{body:JSON.stringify({id:a.state.id}),headers:{"Content-Type":"application/json"},method:"POST"}).then(function(e){return e.json()}).then(function(e){console.log(e),a.props.history.push("/home")}).catch(function(e){return console.log(e)});case 2:e.sent;case 3:case"end":return e.stop()}},e,this)})),a.state={imageList:[],id:a.props.match.params.id,filterName:a.props.location.state.filter},a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.state.imageList;return r.a.createElement("div",null,r.a.createElement(v.a,{type:"primary",onClick:this.deleteAll},"Delete all related images"),r.a.createElement(G.a,null),r.a.createElement(I.a,{gutter:16},e.map(function(e,t){return r.a.createElement(x.a,{span:8,key:t},r.a.createElement(K,{name:e.name,time:e.time,id:e.id,s3Key:e.s3Key,filterName:e.filterName}))})))}}]),t}(n.Component),A=Object(h.g)(J),M=a(93),R=a(318),U=a(315),q=a(320),W=a(316),z={labelCol:{span:8},wrapperCol:{span:8}},H={wrapperCol:{offset:8,span:16}},Y=function(e){return console.log("Upload event:",e),Array.isArray(e)?e:e&&e.fileList},V=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).changeName=function(e){a.setState({name:e.target.value})},a.changeImage=function(e){a.setState({image:e.file})},a.beforeUpload=function(e){return"image/jpeg"===e.type||"image/png"===e.type||"image/jpg"===e.type||"image/bmp"===e.type||R.b.error("You can only upload JPG/PNG file!"),e.size/1024/1024<200||R.b.error("Image must smaller than 200MB!"),!1},a.handleSubmit=function(){var e=Object(S.a)(C.a.mark(function e(t){var n;return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),(n=new FormData).append("name",a.state.name),n.append("image",a.state.image),console.dir(n),console.log(n.get("name")),console.log(n.get("image")),e.next=9,fetch("/api/save",{body:n,method:"POST"}).then(function(e){return e.json()}).then(function(e){console.log(e),a.setState({origin:e.saveOriginImage}),a.setState({isShow:!0})}).catch(function(e){return console.error("Error:",e)});case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a.onFinish=function(e){console.log("Received values of form: ",e)},a.state={name:"",isShow:!1,origin:{},image:{}},a.handleSubmit=a.handleSubmit.bind(Object(M.a)(a)),a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(T.a,{title:"save an origin image"},r.a.createElement(U.a,Object.assign({},z,{onFinish:this.onFinish,name:"saveImage"}),r.a.createElement(U.a.Item,{label:"name",name:"name",rules:[{required:!0,message:"Please input the name of your image!"}]},r.a.createElement(q.a,{placeholder:"Please input the name of your image!",onChange:this.changeName})),r.a.createElement(U.a.Item,{name:"upload",label:"image",valuePropName:"fileList",getValueFromEvent:Y,rules:[{required:!0,message:"Please upload your image!"}]},r.a.createElement(W.a,{name:"logo",listType:"picture",onChange:this.changeImage,beforeUpload:this.beforeUpload},r.a.createElement(v.a,null,"+ Click to upload image"))),r.a.createElement(U.a.Item,H,r.a.createElement(v.a,{type:"primary",htmlType:"submit",onClick:this.handleSubmit},"Save")))),this.state.isShow?r.a.createElement("div",null,r.a.createElement(G.a,null),r.a.createElement(I.a,{gutter:16},r.a.createElement(x.a,{span:8},r.a.createElement(K,{name:this.state.origin.name,time:this.state.origin.time,id:this.state.origin.id,s3Key:this.state.origin.s3Key,filterName:this.state.origin.filterName})))):r.a.createElement("div",null,"waiting for save..."))}}]),t}(n.Component),Q=Object(h.g)(V),X=a(319),Z=X.a.Option,$={labelCol:{span:8},wrapperCol:{span:8}},_={wrapperCol:{offset:8,span:16}},ee=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).changeName=function(e){a.setState({filterName:e})},a.search=function(){var e=Object(S.a)(C.a.mark(function e(t){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,fetch("/api/filterType",{body:JSON.stringify({filterName:a.state.filterName}),headers:{"Content-Type":"application/json"},method:"POST"}).then(function(e){return e.json()}).then(function(e){a.setState({imageList:e.findImagesByFilterType}),console.log(e)}).catch(function(e){return console.log(e)});case 3:e.sent;case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a.state={filterName:"",imageList:[]},a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.state.imageList;return r.a.createElement("div",null,r.a.createElement(T.a,null,r.a.createElement(U.a,Object.assign({},$,{name:"control-hooks"}),r.a.createElement(U.a.Item,{name:"filterName",label:"Filter Type",rules:[{required:!0}]},r.a.createElement(X.a,{placeholder:"Select a filter",allowClear:!0,onChange:this.changeName},r.a.createElement(Z,{value:"Grayscale"},"Grayscale"),r.a.createElement(Z,{value:"MyGray"},"MyGray"),r.a.createElement(Z,{value:"BlackWhite"},"BlackWhite"),r.a.createElement(Z,{value:"Film"},"Film"))),r.a.createElement(U.a.Item,_,r.a.createElement(v.a,{type:"primary",htmlType:"submit",onClick:this.search},"Search")))),e.length>0?r.a.createElement("div",null,r.a.createElement("h1",null,"search result of ",this.state.filterName," as following:"),r.a.createElement(I.a,{gutter:16},e.map(function(e,t){return r.a.createElement(x.a,{span:8,key:t},r.a.createElement(K,{name:e.name,time:e.time,id:e.id,s3Key:e.s3Key,filterName:e.filterName}))}))):this.state.filterName.length>0?r.a.createElement("h1",null,"search result of ",this.state.filterName," as following:"):r.a.createElement("h1",null,"search result will be here"))}}]),t}(n.Component),te=X.a.Option,ae={labelCol:{span:8},wrapperCol:{span:8}},ne={wrapperCol:{offset:8,span:16}},re=[{path:"/home",component:B},{path:"/save",component:Q},{path:"/404",component:D},{path:"/search",component:ee},{path:"/error/:id/:name",component:k},{path:"/update/:id/:name",component:function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).newName=function(e){a.setState({newName:e.target.value})},a.filter=function(e){a.setState({filterName:e})},a.update=Object(S.a)(C.a.mark(function e(){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/update",{body:JSON.stringify({filterName:a.state.filterName,newName:a.state.newName,id:a.state.id,name:a.state.name}),headers:{"Content-Type":"application/json"},method:"POST"}).then(function(e){return e.json()}).then(function(){var e=Object(S.a)(C.a.mark(function e(t){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),a.setState({filtered:t.updateImage}),e.next=4,a.getOrigin();case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){return console.log(e)});case 2:e.sent;case 3:case"end":return e.stop()}},e,this)})),a.getOrigin=Object(S.a)(C.a.mark(function e(){return C.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/origin",{body:JSON.stringify({id:a.state.id,name:a.state.name}),headers:{"Content-Type":"application/json"},method:"POST"}).then(function(e){return e.json()}).then(function(e){console.log(e),a.setState({origin:e.getImageByPrimaryKey}),a.setState({isShow:!0})}).catch(function(e){return console.log(e)});case 2:e.sent;case 3:case"end":return e.stop()}},e,this)})),a.state={id:a.props.match.params.id,name:a.props.match.params.name,filterName:"",newName:"",origin:{},filtered:{},isShow:!1},a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(T.a,null,r.a.createElement(U.a,Object.assign({},ae,{name:"control-hooks"}),r.a.createElement(U.a.Item,{name:"filterName",label:"Filter Type",rules:[{required:!0}]},r.a.createElement(X.a,{placeholder:"Select a filter",allowClear:!0,onChange:this.filter},r.a.createElement(te,{value:"Grayscale"},"Grayscale"),r.a.createElement(te,{value:"MyGray"},"MyGray"),r.a.createElement(te,{value:"BlackWhite"},"BlackWhite"),r.a.createElement(te,{value:"Film"},"Film"))),r.a.createElement(U.a.Item,{label:"name",name:"name",rules:[{required:!0,message:"Please input the name of your image!"}]},r.a.createElement(q.a,{placeholder:"Please input the name of your image!",onChange:this.newName})),r.a.createElement(U.a.Item,ne,r.a.createElement(v.a,{type:"primary",htmlType:"submit",onClick:this.update},"Update")))),this.state.isShow?r.a.createElement("div",null,r.a.createElement(G.a,null),r.a.createElement(I.a,{gutter:16},r.a.createElement(x.a,{span:8},r.a.createElement(K,{name:this.state.origin.name,time:this.state.origin.time,id:this.state.origin.id,s3Key:this.state.origin.s3Key,filterName:this.state.origin.filterName})),r.a.createElement(x.a,{span:8},r.a.createElement(K,{name:this.state.filtered.name,time:this.state.filtered.time,id:this.state.filtered.id,s3Key:this.state.filtered.s3Key,filterName:this.state.filtered.filterName})))):r.a.createElement("div",null,"waiting for update..."))}}]),t}(n.Component)},{path:"/related/:id/:name",component:A}],ie=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(p.a,null,r.a.createElement(O,null,r.a.createElement(h.d,null,re.map(function(e){return r.a.createElement(h.b,{key:e.path,path:e.path,component:e.component})}),r.a.createElement(h.a,{to:"/home",from:"/"}),r.a.createElement(h.a,{to:"/404"}))))}}]),t}(n.Component);o.a.render(r.a.createElement(ie,null),document.getElementById("root"))}},[[163,1,2]]]);
//# sourceMappingURL=main.e8a0f4d6.chunk.js.map